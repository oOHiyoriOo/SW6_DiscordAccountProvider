"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["m-d-discord-login"],{4056:(e,t,s)=>{var o=s(6285),n=s(8254);class a extends o.Z{init(){this.httpClient=new n.Z;const e=new URLSearchParams(window.location.search).get("code"),t=new URLSearchParams(window.location.hash.slice(1)),s=t.get("access_token")||e,[o,a]=[t.get("token_type"),t.get("expires_in")];setTimeout((()=>{this.updateStatusLine("Ah, the mystical pathways seem to have entangled with the sands of time. Fear not, for the magic lingers, awaiting your touch to spark once more. Retrace your steps, cast the spell of login anew, and the realms shall unfold before thee.")}),6e4);let r=window.location,i=r.protocol+"//"+r.host+"/";console.log(`Token: ${s}`);const h=JSON.stringify({accessToken:s,tokenType:o,expires_in:a,base:i});try{this.httpClient.post("/discord/auth",h,(e=>{if(e.startsWith("<"))return void(document.getElementsByTagName("html")[0].innerHTML=e);let t=JSON.parse(e);t&&!t.error&&"redirect"===t.msg&&(window.location.href=t.url),t&&t.error&&t.msg&&this.updateStatusLine(t.msg)}),"application/json")}catch(e){console.error(e),this.updateStatusLine("Ah, the stars have briefly veered off course. Fear not, for the cosmic winds shall soon align again. Please retry the spell of login, and the gateway shall unfold before thee.")}}updateStatusLine(e){const t=document.getElementById("discordOauthStatusLine");t&&(t.innerText=e)}}window.PluginManager.register("DiscordOAuth",a,"[discord-oauth-trigger]")}},e=>{e.O(0,["vendor-node","vendor-shared"],(()=>{return t=4056,e(e.s=t);var t}));e.O()}]);